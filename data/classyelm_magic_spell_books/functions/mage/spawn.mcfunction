# Check New Villagers and Replace Percentage with Mage
tag @e[type=minecraft:villager,tag=!msbv2xvhbc,distance=..25,nbt={Age:0,VillagerData:{level:1},Xp:0}] add msbv2xvntbc
execute as @e[tag=msbv2xvntbc,tag=!msbv2xvhbc] store result score @s msbv2xrngc run random value 1..10

# Detect Random Mage Type
execute as @e[tag=msbv2xvntbc,tag=!msbv2xvhbc,scores={msbv2xrngc=1}] run tag @s add msbv2xvsam
execute as @e[tag=msbv2xvsam] store result score @s msbv2xrngc run random value 1..7
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=1}] run data merge entity @s {CustomName:"{\"text\":\"Earth Mage\"}",Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"coarse_dirt",count:4},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Terraform Spell Book'","minecraft:lore":["{\"text\":\"Costs 3 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"terraform"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=2}] run data merge entity @s {CustomName:"{\"text\":\"Dark Mage\"}",Profession:2,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"minecraft:ender_eye",count:1},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Lurid Explosion Spell Book'","minecraft:lore":["{\"text\":\"Costs 4 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"lurid_explosion"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=3}] run data merge entity @s {CustomName:"{\"text\":\"Air Mage\"}",Profession:2,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"minecraft:feather",count:8},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Updraft Spell Book'","minecraft:lore":["{\"text\":\"Costs 2 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"updraft"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=4}] run data merge entity @s {CustomName:"{\"text\":\"Fire Mage\"}",Profession:2,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"minecraft:fire_charge",count:1},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Flame Ring Spell Book'","minecraft:lore":["{\"text\":\"Costs 1 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"flame"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=5}] run data merge entity @s {CustomName:"{\"text\":\"Light Mage\"}",Profession:2,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"minecraft:glowstone_dust",count:4},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Luminosity Spell Book'","minecraft:lore":["{\"text\":\"Costs 1 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"luminosity"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=6}] run data merge entity @s {CustomName:"{\"text\":\"Water Mage\"}",Profession:2,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:iron_ingot",count:8},buyB:{id:"minecraft:prismarine_crystals",count:1},sell:{id:"minecraft:knowledge_book",count:1,components:{"minecraft:item_name":"'Respiration Spell Book'","minecraft:lore":["{\"text\":\"Costs 7 mana\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:custom_data":{isSpell:true,spellId:"respiration"}}}}]},VillagerData:{profession:"minecraft:librarian",level:5}}
execute as @e[tag=msbv2xvsam,scores={msbv2xrngc=7}] run data merge entity @s {CustomName:"{\"text\":\"Alchemist\"}",Profession:1,Tags:["msbv2xvhbc","msbv2xmv"],Offers:{Recipes:[{buy:{id:"minecraft:emerald",count:2},buyB:{id:"glistering_melon_slice",count:2},sell:{id:"minecraft:potion",count:1,components:{"minecraft:potion_contents":{potion:"minecraft:mundane",custom_color:102},"minecraft:item_name":"'Potion of Mana'","minecraft:rarity":"epic","minecraft:lore":["{\"text\":\"Drink to restore 6 mana points\",\"color\":\"gray\",\"italic\":false}"],"minecraft:enchantment_glint_override":true,"minecraft:hide_additional_tooltip":{},"minecraft:custom_data":{manaPotion:true,isSpell:true}}}},{buy:{id:"minecraft:emerald",count:2},buyB:{id:"glistering_melon_slice",count:2},sell:{id:"minecraft:splash_potion",count:1,components:{"minecraft:potion_contents":{potion:"minecraft:mundane",custom_color:102},"minecraft:item_name":"'Splash Potion of Mana'","minecraft:rarity":"epic","minecraft:lore":["{\"text\":\"Throw to restore 3 mana points\",\"color\":\"gray\",\"italic\":false}"],"minecraft:recipes":["minecraft:stick"],"minecraft:enchantment_glint_override":true,"minecraft:hide_additional_tooltip":{},"minecraft:custom_data":{splashManaPotion:true,isSpell:true}}}}]},VillagerData:{profession:"minecraft:cleric",level:5}}

# Reset
tag @e[tag=msbv2xvntbc,tag=!msbv2xvhbc] add msbv2xvhbc
